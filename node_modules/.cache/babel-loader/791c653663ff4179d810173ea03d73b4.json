{"ast":null,"code":"import React, { useState, useEffect, createContext, forwardRef, useContext } from 'react';\nvar cachedScripts = [];\n\nfunction usePaystackScript() {\n  var src = 'https://js.paystack.co/v1/inline.js';\n\n  var _a = useState({\n    loaded: false,\n    error: false\n  }),\n      state = _a[0],\n      setState = _a[1];\n\n  useEffect(function () {\n    if (cachedScripts.includes(src)) {\n      setState({\n        loaded: true,\n        error: false\n      });\n    } else {\n      cachedScripts.push(src);\n      var script_1 = document.createElement('script');\n      script_1.src = src;\n      script_1.async = true;\n\n      var onScriptLoad_1 = function () {\n        setState({\n          loaded: true,\n          error: false\n        });\n      };\n\n      var onScriptError_1 = function () {\n        var index = cachedScripts.indexOf(src);\n        if (index >= 0) cachedScripts.splice(index, 1);\n        script_1.remove();\n        setState({\n          loaded: true,\n          error: true\n        });\n      };\n\n      script_1.addEventListener('load', onScriptLoad_1);\n      script_1.addEventListener('complete', onScriptLoad_1);\n      script_1.addEventListener('error', onScriptError_1);\n      document.body.appendChild(script_1);\n      return function () {\n        script_1.removeEventListener('load', onScriptLoad_1);\n        script_1.removeEventListener('error', onScriptError_1);\n      };\n    }\n  }, [src]);\n  return [state.loaded, state.error];\n}\n\nvar callPaystackPop = function (paystackArgs) {\n  console.log('callPaystackPop', paystackArgs); //@ts-ignore\n\n  var handler = window.PaystackPop && window.PaystackPop.setup(paystackArgs);\n  handler && handler.openIframe();\n};\n\nfunction usePaystackPayment(options) {\n  var _a = usePaystackScript(),\n      scriptLoaded = _a[0],\n      scriptError = _a[1];\n\n  var publicKey = options.publicKey,\n      email = options.email,\n      amount = options.amount,\n      reference = options.reference,\n      _b = options.metadata,\n      metadata = _b === void 0 ? {} : _b,\n      _c = options.currency,\n      currency = _c === void 0 ? 'NGN' : _c,\n      channels = options.channels,\n      _d = options.label,\n      label = _d === void 0 ? '' : _d,\n      _e = options.plan,\n      plan = _e === void 0 ? '' : _e,\n      _f = options.quantity,\n      quantity = _f === void 0 ? '' : _f,\n      _g = options.subaccount,\n      subaccount = _g === void 0 ? '' : _g,\n      _h = options.transaction_charge,\n      transaction_charge = _h === void 0 ? 0 : _h,\n      _j = options.bearer,\n      bearer = _j === void 0 ? 'account' : _j;\n\n  function initializePayment(callback, onClose) {\n    if (scriptError) {\n      throw new Error('Unable to load paystack inline script');\n    }\n\n    if (scriptLoaded) {\n      var paystackArgs = {\n        callback: callback ? callback : function () {\n          return null;\n        },\n        onClose: onClose ? onClose : function () {\n          return null;\n        },\n        key: publicKey,\n        ref: reference,\n        email: email,\n        amount: amount,\n        currency: currency,\n        plan: plan,\n        quantity: quantity,\n        'data-custom-button': options['data-custom-button'] || '',\n        channels: channels,\n        subaccount: subaccount,\n        transaction_charge: transaction_charge,\n        bearer: bearer,\n        label: label,\n        metadata: metadata\n      };\n      callPaystackPop(paystackArgs);\n    }\n  }\n\n  useEffect(function () {\n    if (scriptError) {\n      throw new Error('Unable to load paystack inline script');\n    }\n  }, [scriptError]);\n  return initializePayment;\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nvar PaystackButton = function (_a) {\n  var text = _a.text,\n      className = _a.className,\n      children = _a.children,\n      onSuccess = _a.onSuccess,\n      onClose = _a.onClose,\n      others = __rest(_a, [\"text\", \"className\", \"children\", \"onSuccess\", \"onClose\"]);\n\n  var initializePayment = usePaystackPayment(others);\n  return React.createElement(\"button\", {\n    className: className,\n    onClick: function () {\n      return initializePayment(onSuccess, onClose);\n    }\n  }, text || children);\n};\n\nvar PaystackContext = createContext({\n  initializePayment: function () {\n    return null;\n  },\n  onSuccess: function () {\n    return null;\n  },\n  onClose: function () {\n    return null;\n  }\n});\n\nvar PaystackProvider = function (_a) {\n  var children = _a.children,\n      onSuccess = _a.onSuccess,\n      onClose = _a.onClose,\n      others = __rest(_a, [\"children\", \"onSuccess\", \"onClose\"]);\n\n  var initializePayment = usePaystackPayment(others);\n  return React.createElement(PaystackContext.Provider, {\n    value: {\n      initializePayment: initializePayment,\n      onSuccess: onSuccess,\n      onClose: onClose\n    }\n  }, children);\n};\n\nvar PaystackConsumerChild = function (_a) {\n  var children = _a.children,\n      ref = _a.ref;\n\n  var _b = useContext(PaystackContext),\n      initializePayment = _b.initializePayment,\n      onSuccess = _b.onSuccess,\n      onClose = _b.onClose;\n\n  var completeInitializePayment = function () {\n    return initializePayment(onSuccess, onClose);\n  };\n\n  return children({\n    initializePayment: completeInitializePayment,\n    ref: ref\n  });\n};\n\nvar PaystackConsumer = forwardRef(function (_a, ref) {\n  var children = _a.children,\n      paraSuccess = _a.onSuccess,\n      paraClose = _a.onClose,\n      others = __rest(_a, [\"children\", \"onSuccess\", \"onClose\"]);\n\n  var onSuccess = paraSuccess ? paraSuccess : function () {\n    return null;\n  };\n  var onClose = paraClose ? paraClose : function () {\n    return null;\n  };\n  return React.createElement(PaystackProvider, __assign({}, others, {\n    onSuccess: onSuccess,\n    onClose: onClose\n  }), React.createElement(PaystackConsumerChild, {\n    ref: ref\n  }, children));\n});\nexport { PaystackButton, PaystackConsumer, usePaystackPayment };","map":null,"metadata":{},"sourceType":"module"}